#!/bin/sh

cd $(dirname $0)
cd ..

PTN='secrets.json'

bash -c "echo -n 'Master Password: '"
read -s password1
echo
bash -c "echo -n 'Master Password confirmation: '"
read -s password2
echo

if [[ $password1 != $password2 ]]; then
    echo "passwords are not matching!"
    exit 1
elif [[ $password1 == "" ]]; then
    echo "Empty Password!"
    exit 1
fi

password=$password1

for filename in `find . -name "$PTN"`
do
    out=${filename}.crypted
    openssl enc -e -aes-256-cbc -in $filename -out $out -k "$password"
    echo crypt to $out
done

