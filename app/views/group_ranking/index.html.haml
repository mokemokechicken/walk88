- content_for :post_head do
  = javascript_include_tag "http://code.highcharts.com/highcharts.js"

%h1 グループの成績

.row-fluid
  .offset2.span8
    %div{:id => 'container'}

.row-fluid
  .offset2.span8.center
    %table.table.table-striped(id="ranking")
      %thead
        %tr
          %th グループ名
          %th 距離スコア
          %th メンバー
      %tbody
        - @group_ranking.each do |info|
          %tr(class="#{info['id'] == @my_group.group_id ? 'success' : ''}" id="group_#{info['id']}")
            %td= info['name']
            %td(id="dist_#{info['id']}")= sprintf('%.1f', info['distance'])
            %td
              - @group_users.select{|gu| info["id"] == gu.group_id}.each do |gu|
                = link_to image_tag(gu.user.image, :alt => gu.user.nickname), user_records_of_user_path(:user_id => gu.user_id)


:coffee
  $ ->
    GroupRanking
      canvas: '#container'
    .init()

%div
  ※ 2014年2月14日~2月末のチームメンバーの距離を使って順位を計算しています。
  「距離スコア」の計算は以下のように行っています。
  %div
    %ul
      %li A = チームの合計距離
      %li B = チームの距離の標準偏差
      %li C = チームの距離の平均
      %li 距離スコア = A × 2^ ( 1 - (B/C) )
  %div
    ニュアンスとしては「全員の距離が近い(標準偏差が小さい)ほど、距離スコアが伸びやすい」です。

